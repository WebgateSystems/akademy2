---
openapi: 3.0.1
info:
  title: My API
  version: v1
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Use POST /api/v1/session to get access_token and paste here
security: []
paths:
  "/api/v1/session":
    post:
      summary: Creates a session
      tags:
      - Session
      parameters: []
      responses:
        '201':
          description: session create
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          email:
                            type: string
                            format: email
                          first_name:
                            type: string
                          last_name:
                            type: string
                          school_id:
                            type: string
                            format: uuid
                          locale:
                            type: string
                          jti:
                            type: string
                            format: uuid
                          metadata:
                            type: object
                          birthdate:
                            type: string
                            format: date
                          phone:
                            type: string
                        additionalProperties: false
                    additionalProperties: false
                  access_token:
                    type: string
                additionalProperties: false
      requestBody:
        content:
          application/json:
            schema:
              properties:
                user:
                  type: object
                  properties:
                    email:
                      type: string
                    password:
                      type: string
              required:
              - email
              - password
  "/api/v1/contents":
    get:
      summary: List contents
      tags:
      - Contents
      security:
      - bearerAuth: []
      parameters:
      - name: learning_module_id
        in: query
        format: uuid
        required: false
        description: Filter by learning module ID
        schema:
          type: string
      responses:
        '200':
          description: contents filtered by learning_module_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            content_type:
                              type: string
                            order_index:
                              type: integer
                            learning_module_id:
                              type: string
                              format: uuid
                            learning_module_title:
                              type: string
                            duration_sec:
                              type: integer
                              nullable: true
                            youtube_url:
                              type: string
                              nullable: true
                            payload:
                              type: object
                              nullable: true
                            file_url:
                              type: string
                              nullable: true
                            file_hash:
                              type: string
                              nullable: true
                            file_format:
                              type: string
                              nullable: true
                            poster_url:
                              type: string
                              nullable: true
                            subtitles_url:
                              type: string
                              nullable: true
                            created_at:
                              type: string
                            updated_at:
                              type: string
        '401':
          description: unauthorized
  "/api/v1/contents/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show content
      tags:
      - Contents
      security:
      - bearerAuth: []
      description: Returns content details. Only contents from published learning
        modules are accessible (unless admin)
      responses:
        '200':
          description: content found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                          content_type:
                            type: string
                          order_index:
                            type: integer
                          learning_module_id:
                            type: string
                            format: uuid
                          learning_module_title:
                            type: string
                          duration_sec:
                            type: integer
                            nullable: true
                          youtube_url:
                            type: string
                            nullable: true
                          payload:
                            type: object
                            nullable: true
                          file_url:
                            type: string
                            nullable: true
                          file_hash:
                            type: string
                            nullable: true
                          file_format:
                            type: string
                            nullable: true
                          poster_url:
                            type: string
                            nullable: true
                          subtitles_url:
                            type: string
                            nullable: true
                          created_at:
                            type: string
                          updated_at:
                            type: string
        '404':
          description: content not found
        '403':
          description: forbidden - content from unpublished module
        '401':
          description: unauthorized
  "/api/v1/headmasters":
    get:
      summary: List headmasters
      tags:
      - Headmasters
      security:
      - bearerAuth: []
      responses:
        '200':
          description: headmasters list
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            first_name:
                              type: string
                            last_name:
                              type: string
                            name:
                              type: string
                            email:
                              type: string
                            school_id:
                              type: string
                              format: uuid
                            school_name:
                              type: string
                              nullable: true
                            phone:
                              type: string
                              nullable: true
                            created_at:
                              type: string
                            updated_at:
                              type: string
        '401':
          description: unauthorized
    post:
      summary: Create headmaster
      tags:
      - Headmasters
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: headmaster created
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                headmaster:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                  required:
                  - first_name
                  - last_name
                  - email
                  - school_id
  "/api/v1/headmasters/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show headmaster
      tags:
      - Headmasters
      security:
      - bearerAuth: []
      responses:
        '200':
          description: headmaster found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
        '404':
          description: headmaster not found
    patch:
      summary: Update headmaster
      tags:
      - Headmasters
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: headmaster updated
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                headmaster:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
    delete:
      summary: Delete headmaster
      tags:
      - Headmasters
      security:
      - bearerAuth: []
      responses:
        '204':
          description: headmaster deleted
        '404':
          description: headmaster not found
  "/api/v1/learning_modules":
    get:
      summary: List learning modules
      tags:
      - Learning Modules
      security:
      - bearerAuth: []
      description: Returns only published learning modules
      responses:
        '200':
          description: learning modules list
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            order_index:
                              type: integer
                            unit_id:
                              type: string
                              format: uuid
                            published:
                              type: boolean
                            single_flow:
                              type: boolean
                            unit_title:
                              type: string
                            subject_title:
                              type: string
                            subject_id:
                              type: string
                              format: uuid
                            contents_count:
                              type: integer
                            created_at:
                              type: string
                            updated_at:
                              type: string
        '401':
          description: unauthorized
  "/api/v1/learning_modules/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show learning module
      tags:
      - Learning Modules
      security:
      - bearerAuth: []
      description: Returns learning module details. Only published modules are accessible
        (unless admin)
      responses:
        '200':
          description: learning module found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                          order_index:
                            type: integer
                          unit_id:
                            type: string
                            format: uuid
                          published:
                            type: boolean
                          single_flow:
                            type: boolean
                          unit_title:
                            type: string
                          subject_title:
                            type: string
                          subject_id:
                            type: string
                            format: uuid
                          contents_count:
                            type: integer
                          created_at:
                            type: string
                          updated_at:
                            type: string
        '404':
          description: learning module not found
        '403':
          description: forbidden - unpublished module
        '401':
          description: unauthorized
  "/api/v1/management/academic_years":
    get:
      summary: List academic years
      tags:
      - Management Academic Years
      security:
      - bearerAuth: []
      responses:
        '200':
          description: academic years list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            type:
                              type: string
                            attributes:
                              type: object
                              properties:
                                id:
                                  type: string
                                  format: uuid
                                year:
                                  type: string
                                school_id:
                                  type: string
                                  format: uuid
                                school_name:
                                  type: string
                                  nullable: true
                                is_current:
                                  type: boolean
                                started_at:
                                  type: string
                                  nullable: true
                                  format: date
                                ended_at:
                                  type: string
                                  nullable: true
                                  format: date
                                classes_count:
                                  type: integer
                                created_at:
                                  type: string
                                updated_at:
                                  type: string
        '401':
          description: unauthorized
        '403':
          description: forbidden for non-school-management users
    post:
      summary: Create academic year
      tags:
      - Management Academic Years
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: academic year created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          type:
                            type: string
                          attributes:
                            type: object
                            properties:
                              id:
                                type: string
                                format: uuid
                              year:
                                type: string
                              school_id:
                                type: string
                                format: uuid
                              is_current:
                                type: boolean
                              started_at:
                                type: string
                                nullable: true
                                format: date
        '422':
          description: duplicate year
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                academic_year:
                  type: object
                  properties:
                    year:
                      type: string
                      example: 2025/2026
                    is_current:
                      type: boolean
                      example: false
                    started_at:
                      type: string
                      format: date
                      nullable: true
                  required:
                  - year
  "/api/v1/management/academic_years/{id}":
    parameters:
    - name: id
      in: path
      description: Academic year ID
      required: true
      schema:
        type: string
    get:
      summary: Show academic year
      tags:
      - Management Academic Years
      security:
      - bearerAuth: []
      responses:
        '200':
          description: academic year found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          type:
                            type: string
                          attributes:
                            type: object
                            properties:
                              id:
                                type: string
                                format: uuid
                              year:
                                type: string
                              school_id:
                                type: string
                                format: uuid
                              is_current:
                                type: boolean
                              started_at:
                                type: string
                                nullable: true
                                format: date
        '404':
          description: academic year not found
    patch:
      summary: Update academic year
      tags:
      - Management Academic Years
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: academic year updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          type:
                            type: string
                          attributes:
                            type: object
                            properties:
                              id:
                                type: string
                                format: uuid
                              year:
                                type: string
                              is_current:
                                type: boolean
        '404':
          description: academic year not found
        '422':
          description: invalid year format
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                academic_year:
                  type: object
                  properties:
                    year:
                      type: string
                      example: 2026/2027
                    is_current:
                      type: boolean
                      example: true
    delete:
      summary: Delete academic year
      tags:
      - Management Academic Years
      security:
      - bearerAuth: []
      responses:
        '204':
          description: academic year deleted
        '422':
          description: cannot delete year with classes
        '404':
          description: academic year not found
  "/api/v1/management/administrations":
    get:
      summary: List administrations
      tags:
      - Management Administrations
      security:
      - bearerAuth: []
      parameters:
      - name: page
        in: query
        required: false
        description: Page number
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: Items per page
        schema:
          type: integer
      - name: search
        in: query
        required: false
        description: Search term
        schema:
          type: string
      responses:
        '200':
          description: filtered by search term
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            type:
                              type: string
                            attributes:
                              type: object
                              properties:
                                id:
                                  type: string
                                  format: uuid
                                first_name:
                                  type: string
                                last_name:
                                  type: string
                                name:
                                  type: string
                                email:
                                  type: string
                                school_id:
                                  type: string
                                  format: uuid
                                school_name:
                                  type: string
                                  nullable: true
                                phone:
                                  type: string
                                  nullable: true
                                birth_date:
                                  type: string
                                  nullable: true
                                roles:
                                  type: array
                                  items:
                                    type: string
                                locked_at:
                                  type: string
                                  nullable: true
                                is_locked:
                                  type: boolean
                                is_confirmed:
                                  type: boolean
                                confirmed_at:
                                  type: string
                                  nullable: true
                                created_at:
                                  type: string
                                updated_at:
                                  type: string
                      pagination:
                        type: object
                        nullable: true
                        properties:
                          page:
                            type: integer
                          per_page:
                            type: integer
                          total:
                            type: integer
                          total_pages:
                            type: integer
                          has_more:
                            type: boolean
        '401':
          description: unauthorized
        '403':
          description: forbidden for non-school-management users
    post:
      summary: Create administration
      tags:
      - Management Administrations
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: administration created with only teacher role (no validation)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          type:
                            type: string
                          attributes:
                            type: object
                            properties:
                              id:
                                type: string
                                format: uuid
                              first_name:
                                type: string
                              last_name:
                                type: string
                              name:
                                type: string
                              email:
                                type: string
                              school_id:
                                type: string
                                format: uuid
                              roles:
                                type: array
                                items:
                                  type: string
                              phone:
                                type: string
                                nullable: true
        '422':
          description: invalid request - missing required fields
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                administration:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    roles:
                      type: array
                      items:
                        type: string
                        enum:
                        - principal
                        - school_manager
                        - teacher
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                  required:
                  - first_name
                  - last_name
                  - email
                  - roles
  "/api/v1/management/administrations/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show administration
      tags:
      - Management Administrations
      security:
      - bearerAuth: []
      responses:
        '200':
          description: administration found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          type:
                            type: string
                          attributes:
                            type: object
                            properties:
                              id:
                                type: string
                                format: uuid
                              first_name:
                                type: string
                              last_name:
                                type: string
                              name:
                                type: string
                              email:
                                type: string
                              school_id:
                                type: string
                                format: uuid
                              roles:
                                type: array
                                items:
                                  type: string
                              phone:
                                type: string
                                nullable: true
        '404':
          description: administration from different school
    patch:
      summary: Update administration
      tags:
      - Management Administrations
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: administration roles updated - remove teacher role
        '422':
          description: invalid request - no administration roles
        '403':
          description: cannot update own roles
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                administration:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    roles:
                      type: array
                      items:
                        type: string
                        enum:
                        - principal
                        - school_manager
                        - teacher
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
    delete:
      summary: Delete administration
      tags:
      - Management Administrations
      security:
      - bearerAuth: []
      responses:
        '204':
          description: administration deleted
        '422':
          description: cannot delete self
        '404':
          description: administration not found
  "/api/v1/management/administrations/{id}/resend_invite":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Resend invite to administration
      tags:
      - Management Administrations
      security:
      - bearerAuth: []
      responses:
        '200':
          description: invite resent
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '404':
          description: administration not found
  "/api/v1/management/administrations/{id}/lock":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Lock or unlock administration account
      tags:
      - Management Administrations
      security:
      - bearerAuth: []
      responses:
        '200':
          description: administration account unlocked
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          attributes:
                            type: object
                            properties:
                              is_locked:
                                type: boolean
                              locked_at:
                                type: string
                                nullable: true
        '422':
          description: cannot lock self
        '404':
          description: administration not found
  "/api/v1/management/notifications/mark_as_read":
    post:
      summary: Mark notification as read
      tags:
      - Management Notifications
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: notification marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: bad request when notification_id is missing
        '404':
          description: notification not found
        '401':
          description: unauthorized
        '403':
          description: forbidden for non-school-management users
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                notification_id:
                  type: string
                  format: uuid
                  description: Notification ID
              required:
              - notification_id
  "/api/v1/management/parents":
    get:
      summary: List parents
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      parameters:
      - name: page
        in: query
        required: false
        description: Page number
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: Items per page
        schema:
          type: integer
      - name: search
        in: query
        required: false
        description: Search term
        schema:
          type: string
      responses:
        '200':
          description: filtered by search term
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            type:
                              type: string
                            attributes:
                              type: object
                              properties:
                                first_name:
                                  type: string
                                last_name:
                                  type: string
                                email:
                                  type: string
                                phone:
                                  type: string
                                  nullable: true
                                birthdate:
                                  type: string
                                  nullable: true
                                is_locked:
                                  type: boolean
                                school_name:
                                  type: string
                                  nullable: true
                                students:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      id:
                                        type: string
                                        format: uuid
                                      first_name:
                                        type: string
                                      last_name:
                                        type: string
                                      birthdate:
                                        type: string
                                        nullable: true
                                      class_name:
                                        type: string
                                      relation:
                                        type: string
                      pagination:
                        type: object
                        nullable: true
                        properties:
                          page:
                            type: integer
                          per_page:
                            type: integer
                          total:
                            type: integer
                          total_pages:
                            type: integer
                          has_more:
                            type: boolean
        '401':
          description: unauthorized
    post:
      summary: Create parent
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: parent created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          type:
                            type: string
                          attributes:
                            type: object
                            properties:
                              first_name:
                                type: string
                              last_name:
                                type: string
                              email:
                                type: string
                              phone:
                                type: string
                                nullable: true
                              is_locked:
                                type: boolean
                              students:
                                type: array
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                parent:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    phone:
                      type: string
                    relation:
                      type: string
                      enum:
                      - mother
                      - father
                      - guardian
                      - other
                    student_ids:
                      type: array
                      items:
                        type: string
                        format: uuid
                  required:
                  - first_name
                  - last_name
                  - email
  "/api/v1/management/parents/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show parent
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      responses:
        '200':
          description: parent found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          type:
                            type: string
                          attributes:
                            type: object
                            properties:
                              first_name:
                                type: string
                              last_name:
                                type: string
                              email:
                                type: string
                              phone:
                                type: string
                                nullable: true
                              is_locked:
                                type: boolean
                              students:
                                type: array
        '404':
          description: parent not found
    patch:
      summary: Update parent
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: parent updated with students
        '404':
          description: parent not found
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                parent:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    phone:
                      type: string
                    relation:
                      type: string
                      enum:
                      - mother
                      - father
                      - guardian
                      - other
                    student_ids:
                      type: array
                      items:
                        type: string
                        format: uuid
    delete:
      summary: Delete parent
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      responses:
        '204':
          description: parent deleted
        '404':
          description: parent not found
  "/api/v1/management/parents/{id}/resend_invite":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Resend invite to parent
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      responses:
        '200':
          description: invite resent
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '404':
          description: parent not found
  "/api/v1/management/parents/{id}/lock":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Lock or unlock parent account
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      responses:
        '200':
          description: parent account unlocked
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          attributes:
                            type: object
                            properties:
                              is_locked:
                                type: boolean
                              locked_at:
                                type: string
                                nullable: true
        '404':
          description: parent not found
  "/api/v1/management/parents/search_students":
    get:
      summary: Search students for parent assignment
      tags:
      - Management Parents
      security:
      - bearerAuth: []
      parameters:
      - name: q
        in: query
        required: true
        description: Search term (min 2 characters)
        schema:
          type: string
      responses:
        '200':
          description: students found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            first_name:
                              type: string
                            last_name:
                              type: string
                            birthdate:
                              type: string
                              nullable: true
                            class_name:
                              type: string
                            email:
                              type: string
        '422':
          description: missing search term
  "/api/v1/management/students":
    get:
      summary: List students
      tags:
      - Management Students
      security:
      - bearerAuth: []
      parameters:
      - name: page
        in: query
        required: false
        description: Page number
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: Items per page
        schema:
          type: integer
      - name: search
        in: query
        required: false
        description: Search term
        schema:
          type: string
      responses:
        '200':
          description: students list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            type:
                              type: string
                            attributes:
                              type: object
                              properties:
                                id:
                                  type: string
                                  format: uuid
                                first_name:
                                  type: string
                                last_name:
                                  type: string
                                name:
                                  type: string
                                email:
                                  type: string
                                school_id:
                                  type: string
                                  format: uuid
                                school_name:
                                  type: string
                                  nullable: true
                                phone:
                                  type: string
                                  nullable: true
                                birth_date:
                                  type: string
                                  nullable: true
                                class_name:
                                  type: string
                                  nullable: true
                                locked_at:
                                  type: string
                                  nullable: true
                                is_locked:
                                  type: boolean
                                is_confirmed:
                                  type: boolean
                                confirmed_at:
                                  type: string
                                  nullable: true
                                created_at:
                                  type: string
                                updated_at:
                                  type: string
                      pagination:
                        type: object
                        nullable: true
                        properties:
                          page:
                            type: integer
                          per_page:
                            type: integer
                          total:
                            type: integer
                          total_pages:
                            type: integer
                          has_more:
                            type: boolean
        '401':
          description: unauthorized
        '403':
          description: forbidden for non-school-management users
    post:
      summary: Create student
      tags:
      - Management Students
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: student created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
                          class_name:
                            type: string
                            nullable: true
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                student:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_class_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                        birth_date:
                          type: string
                  required:
                  - first_name
                  - last_name
                  - email
  "/api/v1/management/students/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show student
      tags:
      - Management Students
      security:
      - bearerAuth: []
      responses:
        '200':
          description: student found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
                          class_name:
                            type: string
                            nullable: true
        '404':
          description: student not found
    patch:
      summary: Update student
      tags:
      - Management Students
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: student updated
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                student:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_class_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                        birth_date:
                          type: string
    delete:
      summary: Delete student
      tags:
      - Management Students
      security:
      - bearerAuth: []
      responses:
        '204':
          description: student deleted
  "/api/v1/management/students/{id}/approve":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Approve student
      tags:
      - Management Students
      security:
      - bearerAuth: []
      responses:
        '200':
          description: student approved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          is_confirmed:
                            type: boolean
        '404':
          description: student not found
  "/api/v1/management/students/{id}/decline":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    delete:
      summary: Decline student
      tags:
      - Management Students
      security:
      - bearerAuth: []
      responses:
        '204':
          description: student declined and deleted
  "/api/v1/management/students/{id}/resend_invite":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Resend invite to student
      tags:
      - Management Students
      security:
      - bearerAuth: []
      responses:
        '200':
          description: invite resent
  "/api/v1/management/students/{id}/lock":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Lock or unlock student account
      tags:
      - Management Students
      security:
      - bearerAuth: []
      responses:
        '200':
          description: student account unlocked
  "/api/v1/register/confirm_pin":
    post:
      summary: Confirm PIN and complete registration
      tags:
      - Register
      parameters: []
      responses:
        '201':
          description: Registration completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          email:
                            type: string
                            format: email
                          first_name:
                            type: string
                          last_name:
                            type: string
                          school_id:
                            type: 'null'
                          locale:
                            type: string
                          jti:
                            type: string
                            format: uuid
                          metadata:
                            type: object
                          birthdate:
                            type: string
                            format: date
                          phone:
                            type: 'null'
                        additionalProperties: false
                    additionalProperties: false
                  access_token:
                    type: string
                additionalProperties: false
        '422':
          description: PIN mismatch
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                flow_id:
                  type: string
                pin:
                  type: string
              required:
              - flow_id
              - pin
  "/api/v1/register/flow":
    get:
      summary: Create a registration flow session
      tags:
      - Register
      responses:
        '201':
          description: Flow created
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          step:
                            type: string
                          data:
                            type: object
                        additionalProperties: false
                    additionalProperties: false
                additionalProperties: false
  "/api/v1/register/profile":
    post:
      summary: Submit profile form
      tags:
      - Register
      parameters: []
      responses:
        '200':
          description: Profile accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          step:
                            type: string
                          data:
                            type: object
                        additionalProperties: false
                    additionalProperties: false
                additionalProperties: false
        '422':
          description: Invalid profile
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                flow_id:
                  type: string
                  format: uuid
                profile:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    birthdate:
                      type: string
                    phone:
                      type: string
                  required:
                  - first_name
                  - last_name
                  - email
                  - birthdate
                  - phone
              required:
              - flow_id
              - profile
  "/api/v1/register/set_pin":
    post:
      summary: Submit PIN (first step)
      tags:
      - Register
      parameters: []
      responses:
        '200':
          description: PIN accepted
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          step:
                            type: string
                          data:
                            type: object
                        additionalProperties: false
                    additionalProperties: false
                additionalProperties: false
        '422':
          description: Invalid PIN
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                flow_id:
                  type: string
                pin:
                  type: string
              required:
              - flow_id
              - pin
  "/api/v1/register/verify_phone":
    post:
      summary: Verify phone code
      tags:
      - Register
      parameters: []
      responses:
        '200':
          description: Phone verified
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          step:
                            type: string
                          data:
                            type: object
                        additionalProperties: false
                    additionalProperties: false
                additionalProperties: false
        '422':
          description: Wrong code
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                flow_id:
                  type: string
                code:
                  type: string
              required:
              - flow_id
              - code
  "/api/v1/schools":
    get:
      summary: List schools
      tags:
      - Schools
      security:
      - bearerAuth: []
      responses:
        '200':
          description: schools list
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            name:
                              type: string
                            slug:
                              type: string
                            address:
                              type: string
                              nullable: true
                            city:
                              type: string
                            postcode:
                              type: string
                              nullable: true
                            country:
                              type: string
                            phone:
                              type: string
                              nullable: true
                            email:
                              type: string
                              nullable: true
                            homepage:
                              type: string
                              nullable: true
                            logo_url:
                              type: string
                              nullable: true
                            created_at:
                              type: string
                            updated_at:
                              type: string
        '401':
          description: unauthorized
    post:
      summary: Create school
      tags:
      - Schools
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: school created
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          name:
                            type: string
                          slug:
                            type: string
                          city:
                            type: string
                          country:
                            type: string
        '422':
          description: invalid request
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                slug:
                  type: string
                address:
                  type: string
                city:
                  type: string
                postcode:
                  type: string
                country:
                  type: string
                phone:
                  type: string
                email:
                  type: string
                homepage:
                  type: string
                logo:
                  type: string
                  format: binary
              required:
              - name
              - city
  "/api/v1/schools/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show school
      tags:
      - Schools
      security:
      - bearerAuth: []
      responses:
        '200':
          description: school found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          name:
                            type: string
                          slug:
                            type: string
                          city:
                            type: string
        '404':
          description: school not found
    patch:
      summary: Update school
      tags:
      - Schools
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: school updated
        '422':
          description: invalid request
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                slug:
                  type: string
                address:
                  type: string
                city:
                  type: string
                postcode:
                  type: string
                country:
                  type: string
                phone:
                  type: string
                email:
                  type: string
                homepage:
                  type: string
                logo:
                  type: string
                  format: binary
    delete:
      summary: Delete school
      tags:
      - Schools
      security:
      - bearerAuth: []
      responses:
        '204':
          description: school deleted
        '404':
          description: school not found
  "/api/v1/student/dashboard":
    get:
      summary: Get student dashboard
      tags:
      - Student
      description: Returns student dashboard with subjects and progress
      security:
      - bearerAuth: []
      responses:
        '200':
          description: dashboard data
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      student:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          email:
                            type: string
                            format: email
                      school:
                        type: object
                        nullable: true
                        properties:
                          id:
                            type: string
                            format: uuid
                          name:
                            type: string
                          logo_url:
                            type: string
                            nullable: true
                      classes:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            name:
                              type: string
                            year:
                              type: string
                      subjects:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            slug:
                              type: string
                            icon_url:
                              type: string
                              nullable: true
                            color_light:
                              type: string
                              nullable: true
                            color_dark:
                              type: string
                              nullable: true
                            total_modules:
                              type: integer
                            completed_modules:
                              type: integer
                            completion_rate:
                              type: integer
                            average_score:
                              type: integer
        '401':
          description: unauthorized
        '403':
          description: student access required
  "/api/v1/student/subjects/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      description: Subject ID
      required: true
      schema:
        type: string
    get:
      summary: Get subject details
      tags:
      - Student
      description: Returns subject with units, modules and progress
      security:
      - bearerAuth: []
      responses:
        '200':
          description: subject details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      subject:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                          slug:
                            type: string
                          icon_url:
                            type: string
                            nullable: true
                          color_light:
                            type: string
                            nullable: true
                          color_dark:
                            type: string
                            nullable: true
                      units:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            order_index:
                              type: integer
                            modules:
                              type: array
                              items:
                                type: object
                                properties:
                                  id:
                                    type: string
                                    format: uuid
                                  title:
                                    type: string
                                  order_index:
                                    type: integer
                                  contents_count:
                                    type: integer
                                  completed:
                                    type: boolean
                                  score:
                                    type: integer
                                    nullable: true
                      progress:
                        type: object
                        properties:
                          total_modules:
                            type: integer
                          completed_modules:
                            type: integer
                          average_score:
                            type: integer
        '401':
          description: unauthorized
        '404':
          description: subject not found
  "/api/v1/student/learning_modules/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      description: Learning module ID
      required: true
      schema:
        type: string
    get:
      summary: Get learning module with contents
      tags:
      - Student
      description: Returns module with video, infographic and quiz for learning flow
      security:
      - bearerAuth: []
      responses:
        '200':
          description: module details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      module:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                          unit_id:
                            type: string
                            format: uuid
                          unit_title:
                            type: string
                          single_flow:
                            type: boolean
                      contents:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            content_type:
                              type: string
                            order_index:
                              type: integer
                            file_url:
                              type: string
                              nullable: true
                            poster_url:
                              type: string
                              nullable: true
                            subtitles_url:
                              type: string
                              nullable: true
                            youtube_url:
                              type: string
                              nullable: true
                            duration_sec:
                              type: integer
                              nullable: true
                            payload:
                              type: object
                              nullable: true
                      quiz:
                        type: object
                        nullable: true
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                          questions:
                            type: array
                          pass_threshold:
                            type: integer
                      previous_result:
                        type: object
                        nullable: true
                        properties:
                          id:
                            type: string
                            format: uuid
                          score:
                            type: integer
                          passed:
                            type: boolean
                          completed_at:
                            type: string
                            format: date-time
                          details:
                            type: object
        '401':
          description: unauthorized
        '404':
          description: module not found
  "/api/v1/student/events":
    post:
      summary: Log student activity event
      tags:
      - Student
      description: Log student activity events (video watched, quiz started, etc.)
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: event logged
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '401':
          description: unauthorized
        '422':
          description: invalid event type
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  error:
                    type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                event_type:
                  type: string
                  enum:
                  - video_started
                  - video_completed
                  - video_progress
                  - infographic_viewed
                  - quiz_started
                  - content_viewed
                  description: Type of event
                content_id:
                  type: string
                  format: uuid
                  description: Content ID (for video/infographic)
                learning_module_id:
                  type: string
                  format: uuid
                  description: Learning module ID
                duration_sec:
                  type: integer
                  description: Video duration in seconds
                progress_sec:
                  type: integer
                  description: Current progress in seconds
                progress_percent:
                  type: integer
                  description: Progress percentage (0-100)
                client:
                  type: string
                  enum:
                  - web
                  - mobile
                  default: web
              required:
              - event_type
  "/api/v1/student/events/batch":
    post:
      summary: Log multiple events (offline sync)
      tags:
      - Student
      description: Log multiple events at once for mobile app offline sync
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: all events logged
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  logged_count:
                    type: integer
                  total_count:
                    type: integer
        '207':
          description: partial success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  logged_count:
                    type: integer
                  total_count:
                    type: integer
                  errors:
                    type: array
                    items:
                      type: object
                      properties:
                        index:
                          type: integer
                        error:
                          type: string
        '401':
          description: unauthorized
        '422':
          description: events must be an array
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                events:
                  type: array
                  items:
                    type: object
                    properties:
                      event_type:
                        type: string
                        enum:
                        - video_started
                        - video_completed
                        - video_progress
                        - infographic_viewed
                        - quiz_started
                        - content_viewed
                      data:
                        type: object
                        description: Event-specific data
                      client:
                        type: string
                        enum:
                        - web
                        - mobile
                      occurred_at:
                        type: string
                        format: date-time
                        description: When event occurred (for offline)
                    required:
                    - event_type
              required:
              - events
  "/api/v1/student/quiz_results":
    get:
      summary: List quiz results
      tags:
      - Student
      description: Returns all completed quiz results for the student
      security:
      - bearerAuth: []
      responses:
        '200':
          description: quiz results list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        score:
                          type: integer
                        passed:
                          type: boolean
                        completed_at:
                          type: string
                          format: date-time
                        learning_module:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                        subject:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
        '401':
          description: unauthorized
    post:
      summary: Submit quiz result
      tags:
      - Student
      description: Submit completed quiz result. Score >= 80% marks as passed.
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: quiz result created (failed)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      score:
                        type: integer
                      passed:
                        type: boolean
                      completed_at:
                        type: string
                        format: date-time
                      message:
                        type: string
        '401':
          description: unauthorized
        '404':
          description: learning module not found
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                learning_module_id:
                  type: string
                  format: uuid
                  description: Learning module ID
                score:
                  type: integer
                  minimum: 0
                  maximum: 100
                  description: Quiz score percentage
                details:
                  type: object
                  description: Additional details (answers, time spent)
              required:
              - learning_module_id
              - score
  "/api/v1/student/videos":
    get:
      summary: List videos
      tags:
      - Student
      description: List all approved videos with optional filtering by subject and
        search
      security:
      - bearerAuth: []
      parameters:
      - name: page
        in: query
        required: false
        description: Page number
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: Items per page
        schema:
          type: integer
      - name: q
        in: query
        required: false
        description: Search query
        schema:
          type: string
      - name: subject_id
        in: query
        format: uuid
        required: false
        description: Filter by subject ID
        schema:
          type: string
      responses:
        '200':
          description: videos list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        title:
                          type: string
                        description:
                          type: string
                          nullable: true
                        file_url:
                          type: string
                          nullable: true
                        thumbnail_url:
                          type: string
                          nullable: true
                        youtube_url:
                          type: string
                          nullable: true
                        duration_sec:
                          type: integer
                          nullable: true
                        likes_count:
                          type: integer
                        liked_by_me:
                          type: boolean
                        author:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            name:
                              type: string
                            is_me:
                              type: boolean
                        subject:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                        school:
                          type: object
                          nullable: true
                          properties:
                            id:
                              type: string
                              format: uuid
                            name:
                              type: string
                        created_at:
                          type: string
                          format: date-time
                        can_delete:
                          type: boolean
                  meta:
                    type: object
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
        '401':
          description: unauthorized
    post:
      summary: Upload video
      tags:
      - Student
      description: Upload a new video. Video will be pending until teacher approval.
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: video uploaded
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      description:
                        type: string
                        nullable: true
                      status:
                        type: string
                      subject:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                  message:
                    type: string
        '401':
          description: unauthorized
        '422':
          description: validation error
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                title:
                  type: string
                  description: Video title
                description:
                  type: string
                  description: Video description
                subject_id:
                  type: string
                  format: uuid
                  description: Subject ID
                file:
                  type: string
                  format: binary
                  description: Video file
              required:
              - title
              - subject_id
              - file
  "/api/v1/student/videos/my":
    get:
      summary: List my videos
      tags:
      - Student
      description: List all videos uploaded by current student (all statuses)
      security:
      - bearerAuth: []
      responses:
        '200':
          description: my videos list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        title:
                          type: string
                        status:
                          type: string
                        subject:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
        '401':
          description: unauthorized
  "/api/v1/student/videos/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      description: Video ID
      required: true
      schema:
        type: string
    get:
      summary: Get video details
      tags:
      - Student
      description: Get video details by ID
      security:
      - bearerAuth: []
      responses:
        '200':
          description: video details
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      description:
                        type: string
                        nullable: true
                      status:
                        type: string
                      author:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          name:
                            type: string
                          is_me:
                            type: boolean
        '401':
          description: unauthorized
        '404':
          description: video not found
    patch:
      summary: Update video
      tags:
      - Student
      description: Update own pending video (title and description only). Cannot update
        approved or rejected videos.
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: video updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      title:
                        type: string
                      description:
                        type: string
                        nullable: true
                      status:
                        type: string
                  message:
                    type: string
        '401':
          description: unauthorized
        '403':
          description: forbidden - not own video
        '422':
          description: cannot update approved video
        '404':
          description: video not found
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                video:
                  type: object
                  properties:
                    title:
                      type: string
                      description: Video title
                    description:
                      type: string
                      description: Video description
                  required:
                  - title
              required:
              - video
    delete:
      summary: Delete video
      tags:
      - Student
      description: Delete own pending video. Cannot delete approved or rejected videos.
      security:
      - bearerAuth: []
      responses:
        '200':
          description: video deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '401':
          description: unauthorized
        '403':
          description: forbidden - not own video
        '404':
          description: video not found
  "/api/v1/student/videos/{id}/like":
    parameters:
    - name: id
      in: path
      format: uuid
      description: Video ID
      required: true
      schema:
        type: string
    post:
      summary: Toggle like on video
      tags:
      - Student
      description: Like or unlike a video
      security:
      - bearerAuth: []
      responses:
        '200':
          description: like toggled
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      liked:
                        type: boolean
                      likes_count:
                        type: integer
        '401':
          description: unauthorized
        '404':
          description: video not found
  "/api/v1/student/videos/subjects":
    get:
      summary: Get subjects for filtering
      tags:
      - Student
      description: Get list of subjects available for video filtering
      security:
      - bearerAuth: []
      responses:
        '200':
          description: subjects list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        title:
                          type: string
                        slug:
                          type: string
        '401':
          description: unauthorized
  "/api/v1/students":
    get:
      summary: List students
      tags:
      - Students
      security:
      - bearerAuth: []
      parameters:
      - name: page
        in: query
        required: false
        description: Page number
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: Items per page
        schema:
          type: integer
      - name: search
        in: query
        required: false
        description: Search term
        schema:
          type: string
      - name: status
        in: query
        required: false
        description: Filter by status (active/inactive)
        schema:
          type: string
      responses:
        '200':
          description: students list
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            first_name:
                              type: string
                            last_name:
                              type: string
                            name:
                              type: string
                            email:
                              type: string
                            school_id:
                              type: string
                              format: uuid
                              nullable: true
                            school_name:
                              type: string
                              nullable: true
                            phone:
                              type: string
                              nullable: true
                            birth_date:
                              type: string
                              nullable: true
                            locked_at:
                              type: string
                              nullable: true
                            is_locked:
                              type: boolean
                            created_at:
                              type: string
                            updated_at:
                              type: string
                  pagination:
                    type: object
                    nullable: true
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
                      has_more:
                        type: boolean
        '401':
          description: unauthorized
    post:
      summary: Create student
      tags:
      - Students
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: student created
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                student:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                        birth_date:
                          type: string
                  required:
                  - first_name
                  - last_name
                  - email
                  - school_id
  "/api/v1/students/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show student
      tags:
      - Students
      security:
      - bearerAuth: []
      responses:
        '200':
          description: student found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
                          school_name:
                            type: string
                            nullable: true
                          phone:
                            type: string
                            nullable: true
                          birth_date:
                            type: string
                            nullable: true
                          locked_at:
                            type: string
                            nullable: true
                          is_locked:
                            type: boolean
        '404':
          description: student not found
    patch:
      summary: Update student
      tags:
      - Students
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: student updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
                          school_name:
                            type: string
                            nullable: true
                          phone:
                            type: string
                            nullable: true
                          birth_date:
                            type: string
                            nullable: true
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                student:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                        birth_date:
                          type: string
    delete:
      summary: Delete student
      tags:
      - Students
      security:
      - bearerAuth: []
      responses:
        '204':
          description: student deleted
        '404':
          description: student not found
  "/api/v1/students/{id}/resend_invite":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Resend invite to student
      tags:
      - Students
      security:
      - bearerAuth: []
      responses:
        '200':
          description: invite resent
        '404':
          description: student not found
  "/api/v1/students/{id}/lock":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Lock or unlock student account
      tags:
      - Students
      security:
      - bearerAuth: []
      responses:
        '200':
          description: student unlocked
        '404':
          description: student not found
  "/api/v1/subjects":
    get:
      summary: List subjects
      tags:
      - Subjects
      security:
      - bearerAuth: []
      responses:
        '200':
          description: subjects list
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            slug:
                              type: string
                            order_index:
                              type: integer
                            icon_url:
                              type: string
                              nullable: true
                            color_light:
                              type: string
                              nullable: true
                            color_dark:
                              type: string
                              nullable: true
                            created_at:
                              type: string
                            updated_at:
                              type: string
        '401':
          description: unauthorized
  "/api/v1/subjects/with_contents":
    get:
      summary: List subjects with contents
      tags:
      - Subjects
      security:
      - bearerAuth: []
      description: Returns all subjects with full structure (unit  learning_module
         contents) for offline mode
      responses:
        '200':
          description: subjects with contents
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            slug:
                              type: string
                            order_index:
                              type: integer
                            icon_url:
                              type: string
                              nullable: true
                            color_light:
                              type: string
                              nullable: true
                            color_dark:
                              type: string
                              nullable: true
                            unit:
                              type: object
                              nullable: true
                              properties:
                                id:
                                  type: string
                                  format: uuid
                                title:
                                  type: string
                                order_index:
                                  type: integer
                                learning_module:
                                  type: object
                                  nullable: true
                                  properties:
                                    id:
                                      type: string
                                      format: uuid
                                    title:
                                      type: string
                                    order_index:
                                      type: integer
                                    published:
                                      type: boolean
                                    single_flow:
                                      type: boolean
                                    contents:
                                      type: array
                                      items:
                                        type: object
                                        properties:
                                          id:
                                            type: string
                                            format: uuid
                                          title:
                                            type: string
                                          content_type:
                                            type: string
                                          order_index:
                                            type: integer
                                          duration_sec:
                                            type: integer
                                            nullable: true
                                          youtube_url:
                                            type: string
                                            nullable: true
                                          payload:
                                            type: object
                                            nullable: true
                                          file_url:
                                            type: string
                                            nullable: true
                                          file_hash:
                                            type: string
                                            nullable: true
                                          file_format:
                                            type: string
                                            nullable: true
                                          poster_url:
                                            type: string
                                            nullable: true
                                          subtitles_url:
                                            type: string
                                            nullable: true
        '401':
          description: unauthorized
  "/api/v1/subjects/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show subject
      tags:
      - Subjects
      security:
      - bearerAuth: []
      description: Returns subject details with full structure (unit  learning_module
         contents)
      responses:
        '200':
          description: subject found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                          slug:
                            type: string
                          order_index:
                            type: integer
                          icon_url:
                            type: string
                            nullable: true
                          color_light:
                            type: string
                            nullable: true
                          color_dark:
                            type: string
                            nullable: true
                          unit:
                            type: object
                            nullable: true
                            properties:
                              id:
                                type: string
                                format: uuid
                              title:
                                type: string
                              order_index:
                                type: integer
                              learning_module:
                                type: object
                                nullable: true
                                properties:
                                  id:
                                    type: string
                                    format: uuid
                                  title:
                                    type: string
                                  order_index:
                                    type: integer
                                  published:
                                    type: boolean
                                  single_flow:
                                    type: boolean
                                  contents:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        id:
                                          type: string
                                          format: uuid
                                        title:
                                          type: string
                                        content_type:
                                          type: string
                                        order_index:
                                          type: integer
                                        duration_sec:
                                          type: integer
                                          nullable: true
                                        youtube_url:
                                          type: string
                                          nullable: true
                                        payload:
                                          type: object
                                          nullable: true
                                        file_url:
                                          type: string
                                          nullable: true
                                        file_hash:
                                          type: string
                                          nullable: true
                                        file_format:
                                          type: string
                                          nullable: true
                                        poster_url:
                                          type: string
                                          nullable: true
                                        subtitles_url:
                                          type: string
                                          nullable: true
        '404':
          description: subject not found
        '401':
          description: unauthorized
  "/api/v1/teachers":
    get:
      summary: List teachers
      tags:
      - Teachers
      security:
      - bearerAuth: []
      parameters:
      - name: page
        in: query
        required: false
        description: Page number
        schema:
          type: integer
      - name: per_page
        in: query
        required: false
        description: Items per page
        schema:
          type: integer
      - name: search
        in: query
        required: false
        description: Search term
        schema:
          type: string
      - name: status
        in: query
        required: false
        description: Filter by status (active/inactive)
        schema:
          type: string
      responses:
        '200':
          description: teachers list
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            first_name:
                              type: string
                            last_name:
                              type: string
                            name:
                              type: string
                            email:
                              type: string
                            school_id:
                              type: string
                              format: uuid
                              nullable: true
                            school_name:
                              type: string
                              nullable: true
                            phone:
                              type: string
                              nullable: true
                            birth_date:
                              type: string
                              nullable: true
                            subjects:
                              type: array
                              items:
                                type: string
                            locked_at:
                              type: string
                              nullable: true
                            is_locked:
                              type: boolean
                            created_at:
                              type: string
                            updated_at:
                              type: string
                  pagination:
                    type: object
                    nullable: true
                    properties:
                      page:
                        type: integer
                      per_page:
                        type: integer
                      total:
                        type: integer
                      total_pages:
                        type: integer
                      has_more:
                        type: boolean
        '401':
          description: unauthorized
    post:
      summary: Create teacher
      tags:
      - Teachers
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '201':
          description: teacher created
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                teacher:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                        birth_date:
                          type: string
                  required:
                  - first_name
                  - last_name
                  - email
                  - school_id
  "/api/v1/teachers/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show teacher
      tags:
      - Teachers
      security:
      - bearerAuth: []
      responses:
        '200':
          description: teacher found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          first_name:
                            type: string
                          last_name:
                            type: string
                          name:
                            type: string
                          email:
                            type: string
                          school_id:
                            type: string
                            format: uuid
                            nullable: true
                          school_name:
                            type: string
                            nullable: true
                          phone:
                            type: string
                            nullable: true
                          birth_date:
                            type: string
                            nullable: true
                          subjects:
                            type: array
                            items:
                              type: string
                          locked_at:
                            type: string
                            nullable: true
                          is_locked:
                            type: boolean
        '404':
          description: teacher not found
    patch:
      summary: Update teacher
      tags:
      - Teachers
      security:
      - bearerAuth: []
      parameters: []
      responses:
        '200':
          description: teacher updated
        '422':
          description: invalid request
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                teacher:
                  type: object
                  properties:
                    first_name:
                      type: string
                    last_name:
                      type: string
                    email:
                      type: string
                    school_id:
                      type: string
                      format: uuid
                    metadata:
                      type: object
                      properties:
                        phone:
                          type: string
                        birth_date:
                          type: string
    delete:
      summary: Delete teacher
      tags:
      - Teachers
      security:
      - bearerAuth: []
      responses:
        '204':
          description: teacher deleted
        '404':
          description: teacher not found
  "/api/v1/teachers/{id}/resend_invite":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Resend invite to teacher
      tags:
      - Teachers
      security:
      - bearerAuth: []
      responses:
        '200':
          description: invite resent
        '404':
          description: teacher not found
  "/api/v1/teachers/{id}/lock":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    post:
      summary: Lock or unlock teacher account
      tags:
      - Teachers
      security:
      - bearerAuth: []
      responses:
        '200':
          description: teacher unlocked
        '404':
          description: teacher not found
  "/api/v1/units":
    get:
      summary: List units
      tags:
      - Units
      security:
      - bearerAuth: []
      parameters:
      - name: subject_id
        in: query
        format: uuid
        required: false
        description: Filter by subject ID
        schema:
          type: string
      responses:
        '200':
          description: units filtered by subject_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        type:
                          type: string
                        attributes:
                          type: object
                          properties:
                            id:
                              type: string
                              format: uuid
                            title:
                              type: string
                            order_index:
                              type: integer
                            subject_id:
                              type: string
                              format: uuid
                            subject_title:
                              type: string
                            created_at:
                              type: string
                            updated_at:
                              type: string
        '401':
          description: unauthorized
  "/api/v1/units/{id}":
    parameters:
    - name: id
      in: path
      format: uuid
      required: true
      schema:
        type: string
    get:
      summary: Show unit
      tags:
      - Units
      security:
      - bearerAuth: []
      responses:
        '200':
          description: unit found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      id:
                        type: string
                        format: uuid
                      type:
                        type: string
                      attributes:
                        type: object
                        properties:
                          id:
                            type: string
                            format: uuid
                          title:
                            type: string
                          order_index:
                            type: integer
                          subject_id:
                            type: string
                            format: uuid
                          subject_title:
                            type: string
                          created_at:
                            type: string
                          updated_at:
                            type: string
        '404':
          description: unit not found
        '401':
          description: unauthorized
